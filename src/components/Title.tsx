"use client"

import React, { useEffect, useRef } from 'react';
import gsap from 'gsap';
import { ScrollTrigger } from 'gsap/ScrollTrigger';
gsap.registerPlugin(ScrollTrigger);

interface TitleProps {
  className?: string;
  startPoint?: string;
}

const Title = ({className, startPoint}: TitleProps) => {
  const svgRef = useRef<SVGSVGElement | null>(null);

  useEffect(() => {
      if (svgRef.current) {
        const paths = Array.from(svgRef.current.querySelectorAll('path')).slice(0, 9);
        const logoContainer = svgRef.current.querySelector('#logoContainer');
        const NFTletters = Array.from(svgRef.current.querySelectorAll('path')).slice(9, 13);
        const dashes = Array.from(svgRef.current.querySelectorAll('rect')).slice(1, 6);
        if(NFTletters && logoContainer && dashes){
          const NFTlettersTimeline = gsap.timeline({
            scrollTrigger: {
              trigger: logoContainer,
              start: startPoint,
              toggleActions: 'play reset play reset',
            }
          });
          gsap.set(NFTletters[0], {
            x: 50,
            y: 70,
          });
          gsap.set(NFTletters[1], {
            x: -50,
            y: 0,
          })
          gsap.set(NFTletters[2], {
            x: 50,
            y: -70,
          })
          NFTletters.forEach((letter, index) => {
            NFTlettersTimeline.to(letter, {
              x: 0,
              y: 0,
              duration: 1,
              ease: 'power3.inOut',
            }, "<")
          })
          dashes.forEach((dash, index) => {
            gsap.set(dash, {
              width: 0,
            });
          })
          dashes.forEach((dash, index) => {
            const dashWidth = dash.getAttribute('width');
            if (dashWidth && index > 0) {
              NFTlettersTimeline.to(dash, {
                width: dashWidth,
                duration: 0.5,
                ease: 'power2.inOut',
              },"<")
            }else if(dashWidth){
              NFTlettersTimeline.to(dash, {
                width: dashWidth,
                duration: 0.5,
                ease: 'power2.inOut',
              })
            }
          })
        }
        if(logoContainer){
          const logoContainerLength = (logoContainer as SVGGeometryElement).getTotalLength();
          gsap.set(logoContainer, {
            strokeDasharray: logoContainerLength,
            strokeDashoffset: logoContainerLength,
          });
          const logoContainerTimeline = gsap.timeline({
            scrollTrigger: {
              trigger: logoContainer,
              start: startPoint,
              toggleActions: 'play reset play reset',
            }
          });
          logoContainerTimeline.to(logoContainer, {
            strokeDashoffset: 0,
            duration: 2,
            ease: 'power3.inOut',
          });
        }

        paths.forEach((path) => {
          const length = path.getTotalLength();
          gsap.set(path, {
            strokeDasharray: length,
            strokeDashoffset: length,
            fill: 'none'
          });
          const timeline = gsap.timeline({
            scrollTrigger: {
              trigger: svgRef.current,
              start: startPoint,
              toggleActions: 'play reset play reset',
            }
          });
          timeline.to(path, {
            strokeDashoffset: 0,
            duration: 2,
            ease: 'power3.inOut',
          });
          timeline.to(path, {
            fill: '#ce8eeb',
            duration: 0.5,
            ease: 'power2.inOut',
          });
        });
      }
    }, [svgRef]);
    
  
  return (
    <svg 
      ref={svgRef}
      width="3802" height="370" viewBox="0 0 3802 370" fill="none" xmlns="http://www.w3.org/2000/svg" className={className}>
      <path d="M3185.02 357V360.5H3188.52H3337.52C3398.18 360.5 3444.33 346.051 3475.31 316.534C3506.31 286.987 3521.52 242.917 3521.52 185C3521.52 127.083 3506.31 83.0132 3475.31 53.4662C3444.33 23.9492 3398.18 9.50001 3337.52 9.50001H3188.52H3185.02V13V357ZM3335.52 271H3302.52V99H3335.52C3358.08 99 3374.37 105.035 3385.08 116.513C3395.83 128.036 3401.52 145.648 3401.52 170V200C3401.52 224.352 3395.83 241.964 3385.08 253.488C3374.37 264.965 3358.08 271 3335.52 271Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <path d="M3015.36 359.29L3016.41 360.5H3018.01H3114.51H3118.01V357V13V9.50001H3114.51H3013.01H3009.51V13V173L2871.18 10.7294L2870.13 9.50001H2868.51H2772.01H2768.51V13V357V360.5H2772.01H2873.51H2877.01V357V199.394L3015.36 359.29Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <path d="M2397.77 328.691L2397.78 328.697L2397.78 328.703C2428.62 354.06 2471.86 366.5 2527.01 366.5C2582.16 366.5 2625.23 354.061 2655.75 328.691C2686.39 303.215 2701.51 266.291 2701.51 218.5V13V9.50001H2698.01H2587.51H2584.01V13V217C2584.01 235.312 2578.89 249.742 2568.92 260.638L2568.91 260.659L2568.89 260.679C2559.39 271.408 2545.45 277 2526.51 277C2507.54 277 2493.6 271.561 2484.11 261.16C2474.48 250.279 2469.51 235.681 2469.51 217V13V9.50001H2466.01H2355.51H2352.01V13V218.5C2352.01 266.291 2367.13 303.215 2397.77 328.691Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <path d="M1970.1 320.54L1970.11 320.553L1970.12 320.566C2003.3 351.349 2050.1 366.5 2110 366.5C2169.92 366.5 2216.72 351.177 2249.9 320.053C2283.14 288.87 2299.5 243.654 2299.5 185C2299.5 126.346 2283.14 81.1299 2249.9 49.9474C2216.72 18.8234 2169.92 3.5 2110 3.5C2050.09 3.5 2003.29 18.8231 1970.11 49.9466C1937.19 80.8062 1921 126.033 1921 185C1921 243.97 1937.19 289.352 1970.1 320.54ZM2161.38 256.682L2161.37 256.7L2161.35 256.717C2149.84 270.09 2132.93 277 2110 277C2087.08 277 2070.16 270.09 2058.66 256.717C2047.01 243.183 2041 224.741 2041 201V169C2041 145.259 2047.01 126.817 2058.66 113.283C2070.16 99.9104 2087.08 93 2110 93C2132.93 93 2149.84 99.9104 2161.35 113.283L2161.37 113.3L2161.38 113.318C2173.34 126.852 2179.5 145.281 2179.5 169V201C2179.5 224.719 2173.34 243.148 2161.38 256.682Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <path d="M1546.34 357V360.5H1549.84H1781.84C1800.68 360.5 1818.06 356.557 1833.91 348.631C1849.77 340.698 1862.27 329.615 1871.29 315.383C1880.68 300.775 1885.34 284.11 1885.34 265.5C1885.34 241.307 1879.76 221.489 1868.25 206.379C1858.17 193.144 1843.77 183.817 1825.31 178.249C1841.19 172.376 1853.59 163.426 1862.31 151.293C1872.43 137.213 1877.34 119.188 1877.34 97.5C1877.34 80.8372 1872.82 65.6673 1863.77 52.0844C1855.08 38.5321 1843.09 28.1222 1827.9 20.8623C1813.04 13.272 1796.67 9.50001 1778.84 9.50001H1549.84H1546.34V13V357ZM1751.79 137.106L1751.79 137.112C1747.83 141.347 1742.79 143.5 1736.34 143.5H1663.84V92H1736.34C1742.33 92 1747.42 94.231 1751.79 98.8938L1751.83 98.935L1751.87 98.9749C1756.19 103.292 1758.34 108.556 1758.34 115V120C1758.34 126.825 1756.15 132.456 1751.79 137.106ZM1759.79 267.106L1759.79 267.112C1755.83 271.347 1750.79 273.5 1744.34 273.5H1663.84V221.5H1744.34C1750.71 221.5 1755.73 223.761 1759.71 228.305L1759.79 228.392L1759.87 228.475C1764.15 232.76 1766.34 238.175 1766.34 245V250C1766.34 256.825 1764.15 262.456 1759.79 267.106Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <path d="M1216.35 9.50001H1212.85V13V357V360.5H1216.35H1503.35H1506.85V357V269V265.5H1503.35H1330.35V13V9.50001H1326.85H1216.35Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <path d="M842.106 328.691L842.113 328.697L842.121 328.703C872.959 354.06 916.192 366.5 971.344 366.5C1026.49 366.5 1069.57 354.061 1100.08 328.691C1130.72 303.215 1145.84 266.291 1145.84 218.5V13V9.50001H1142.34H1031.84H1028.34V13V217C1028.34 235.312 1023.22 249.742 1013.26 260.638L1013.24 260.659L1013.22 260.679C1003.72 271.408 989.79 277 970.844 277C951.877 277 937.941 271.561 928.447 261.16C918.819 250.279 913.844 235.681 913.844 217V13V9.50001H910.344H799.844H796.344V13V218.5C796.344 266.291 811.466 303.215 842.106 328.691Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <path d="M414.432 320.54L414.446 320.553L414.459 320.566C447.636 351.349 494.434 366.5 554.34 366.5C614.255 366.5 661.058 351.177 694.235 320.053C727.473 288.87 743.84 243.654 743.84 185C743.84 126.346 727.473 81.1299 694.235 49.9474C661.058 18.8234 614.255 3.5 554.34 3.5C494.425 3.5 447.622 18.8231 414.446 49.9466C381.529 80.8062 365.34 126.033 365.34 185C365.34 243.97 381.53 289.352 414.432 320.54ZM605.717 256.682L605.702 256.7L605.687 256.717C594.18 270.09 577.265 277 554.34 277C531.415 277 514.499 270.09 502.993 256.717C491.347 243.183 485.34 224.741 485.34 201V169C485.34 145.259 491.347 126.817 502.993 113.283C514.499 99.9104 531.415 93 554.34 93C577.265 93 594.18 99.9104 605.687 113.283L605.702 113.3L605.717 113.318C617.678 126.852 623.84 145.281 623.84 169V201C623.84 224.719 617.678 243.148 605.717 256.682Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <path d="M322.5 113V112.967L322.499 112.933C321.812 76.8225 306.751 49.3658 277.363 31.0369C248.321 12.5914 211.455 3.5 167 3.5C121.878 3.5 84.1986 12.5913 54.1738 31.0142C24.0051 49.3951 9 78.2742 9 117C9 143.299 16.0153 164.555 30.4128 180.357C44.4451 195.758 60.9166 206.921 79.8039 213.789L79.8305 213.799L79.8572 213.808C98.3713 220.204 121.687 226.405 149.767 232.422L149.785 232.426L149.804 232.43C172.773 237.091 188.967 241.533 198.608 245.711L198.672 245.739L198.737 245.764C203.55 247.627 206.855 249.882 208.942 252.373C210.977 254.802 212 257.623 212 261C212 265.066 210.993 268.155 209.209 270.513C207.414 272.886 204.594 274.829 200.429 276.168L200.411 276.174L200.393 276.18C191.876 279.019 180.785 280.5 167 280.5C148.24 280.5 135.062 277.682 126.904 272.563C119.38 267.522 115 257.361 115 240.5V237H111.5H7H3.5V240.5C3.5 286.952 18.6452 320.16 49.6845 338.992L49.6918 338.997L49.6993 339.001C80.4597 357.458 123.011 366.5 177 366.5C223.467 366.5 260.927 356.569 289.038 336.345C317.811 315.887 332 284.54 332 243V242.976L332 242.951C331.657 218.292 324.614 198.37 310.535 183.586C296.824 169.19 280.682 158.878 262.145 152.692C244.27 146.287 221.44 140.252 193.702 134.571L193.69 134.569L193.677 134.566C170.046 129.906 153.156 125.457 142.817 121.257C137.853 119.241 134.418 116.795 132.233 114.064C130.091 111.386 129 108.252 129 104.5C129 99.9054 131.664 95.5436 138.695 91.5626C145.961 87.6361 156.615 85.5 171 85.5C185.563 85.5 195.718 88.7468 202.146 94.5898C208.742 100.586 212 107.976 212 117V119V122.5H215.5H319H322.5V119V113Z"  stroke="#CE8EEB" strokeWidth="7"/>
      <rect x="3601.5" y="16.5" width="197" height="215" rx="11.5" stroke="#CE8EEB" strokeWidth="7" id='logoContainer'/>
      <path d="M3626.5 74L3627 70V39H3632L3648.8 64.2L3650.75 69.1H3651.15V43L3650.65 39H3655.9L3655.4 43V74H3650.4L3633.6 48.8L3631.65 43.95H3631.25V70L3631.75 74H3626.5Z" fill="#CE8EEB"/>
      <path d="M3749.5 142L3750 138V111L3749.5 107H3769.5V111.4L3766.5 110.9H3754.3V122.9H3768.5V127.2L3765.5 126.8H3754.3V138L3754.8 142H3749.5Z" fill="#CE8EEB"/>
      <path d="M3639.8 213L3640.3 209V179.8H3644.55V209L3645.05 213H3639.8ZM3629.4 182.4V178H3655.45V182.4L3652.45 181.9H3632.4L3629.4 182.4Z" fill="#CE8EEB"/>
      <rect x="3666" y="39" width="105" height="35" fill="#CE8EEB"/>
      <rect x="3628" y="82" width="143" height="15" fill="#CE8EEB"/>
      <rect x="3628" y="108" width="117" height="34" fill="#CE8EEB"/>
      <rect x="3661" y="177" width="110" height="34" fill="#CE8EEB"/>
      <rect x="3628" y="153" width="143" height="14" fill="#CE8EEB"/>
    </svg>
  )
}
    




;

export default Title;